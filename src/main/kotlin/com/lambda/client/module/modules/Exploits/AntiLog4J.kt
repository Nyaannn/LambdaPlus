package com.lambda.client.module.modules.Exploits
import com.lambda.client.event.listener.listener
import com.lambda.client.module.Category
import com.lambda.client.module.Module
import net.minecraftforge.client.event.ClientChatReceivedEvent

object AntiLog4J : Module(
    name = "AntiLog4J",
    description = "Filters l4shell messages",
    category = Category.EXPLOITS
) {
    init {
        onEnable {

        }
        listener<ClientChatReceivedEvent> {
            if(this.isEnabled == true) {
                if (it.message.unformattedText.toLowerCase().contains("jndi")) {
                    it.isCanceled = true
                }
                if (it.message.unformattedText.toLowerCase().contains("ldap")) {
                    it.isCanceled = true
                }
                if (it.message.unformattedText.toLowerCase().contains("corba")) {
                    it.isCanceled = true
                }
                if (it.message.unformattedText.toLowerCase().contains("\${")) {
                    it.isCanceled = true
                }


            }
        }
    }
}
